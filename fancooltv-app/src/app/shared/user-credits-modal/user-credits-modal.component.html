<div class="modal-header">
  <h4 class="modal-title">Credits Management</h4>
  <button type="button" class="btn-close" aria-label="Close" (click)="close()"></button>
</div>

<div class="modal-body">
  <!-- Stato di caricamento -->
  <div *ngIf="loading" class="text-center my-4">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-2">Loading credits...</p>
  </div>

  <!-- Messaggio di errore -->
  <div *ngIf="error" class="alert alert-danger fw-bold">
    <i class="fas fa-exclamation-triangle me-2"></i>
    {{ error }}
  </div>

  <!-- Messaggio di successo -->
  <div *ngIf="success" class="alert alert-success fw-bold">
    <i class="fas fa-check-circle me-2"></i>
    {{ success }}
  </div>

  <!-- Contenuto principale -->
  <div *ngIf="!loading">
    <div class="credit-balance-section mb-4 text-center">
      <h5>Your Current Balance</h5>
      <div class="credit-balance">
        <i class="fas fa-coins me-2 text-warning"></i>
        <span class="fs-1 fw-bold">{{ currentBalance }}</span>
        <span class="ms-2">credits</span>
      </div>
      <p class="mt-2 fw-bold text-primary">
        Each video playback consumes 20 credits.
      </p>
    </div>

    <div class="add-credits-section">
      <h5>Add Credits</h5>
      <form [formGroup]="addCreditsForm" (ngSubmit)="addCredits()">
        <div class="mb-3">
          <label for="creditAmount" class="form-label">Amount of credits to add:</label>
          <input 
            type="number" 
            class="form-control" 
            id="creditAmount" 
            formControlName="amount"
            min="20"
            max="1000"
            step="20">
          <div class="form-text fw-bold text-primary">Minimum 20, maximum 1000 credits per transaction.</div>
          
          <!-- Errori di validazione -->
          <div *ngIf="addCreditsForm.get('amount')?.invalid && addCreditsForm.get('amount')?.touched" class="text-danger mt-1">
            <small *ngIf="addCreditsForm.get('amount')?.errors?.['required']">Amount is required.</small>
            <small *ngIf="addCreditsForm.get('amount')?.errors?.['min']">Minimum amount is 20 credits.</small>
            <small *ngIf="addCreditsForm.get('amount')?.errors?.['max']">Maximum amount is 1000 credits.</small>
          </div>
        </div>
        
        <button 
          type="submit" 
          class="btn btn-primary w-100" 
          [disabled]="addCreditsForm.invalid || addingCredits">
          <span *ngIf="!addingCredits">
            <i class="fas fa-plus-circle me-2"></i>Add Credits
          </span>
          <span *ngIf="addingCredits">
            <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
            Processing...
          </span>
        </button>
      </form>
    </div>
  </div>
</div>

